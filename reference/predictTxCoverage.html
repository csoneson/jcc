<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Predict coverage profiles of transcripts — predictTxCoverage • jcc</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Predict coverage profiles of transcripts — predictTxCoverage"><meta property="og:description" content="This function predicts coverage profiles for each transcript in a specified
set of genes (or all transcripts in the reference catalog), based on the
fragment bias model estimated by alpine."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jcc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/JCCscore.html">Calculating JCC scores</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predict coverage profiles of transcripts</h1>

    <div class="hidden name"><code>predictTxCoverage.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function predicts coverage profiles for each transcript in a specified
set of genes (or all transcripts in the reference catalog), based on the
fragment bias model estimated by <code>alpine</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predictTxCoverage</span><span class="op">(</span><span class="va">biasModel</span>, <span class="va">exonsByTx</span>, <span class="va">bam</span>, <span class="va">genes</span>, <span class="va">nCores</span>, <span class="va">tx2gene</span>, <span class="va">genome</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-biasmodel">biasModel<a class="anchor" aria-label="anchor" href="#arg-biasmodel"></a></dt>
<dd><p>Bias model from <code>alpine</code>. Can be generated using the
<code><a href="fitAlpineBiasModel.html">fitAlpineBiasModel</a></code> function.</p></dd>


<dt id="arg-exonsbytx">exonsByTx<a class="anchor" aria-label="anchor" href="#arg-exonsbytx"></a></dt>
<dd><p>A <code>GRangesList</code> grouping exons by transcript. Can be
generated using the <code><a href="fitAlpineBiasModel.html">fitAlpineBiasModel</a></code> function.</p></dd>


<dt id="arg-bam">bam<a class="anchor" aria-label="anchor" href="#arg-bam"></a></dt>
<dd><p>Path to bam file with read alignments to the genome.</p></dd>


<dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>Character vector of gene IDs. Coverage profiles will be
estimated for all transcripts annotated to any of these genes. If set to
<code>NULL</code>, coverage profiles will be estimated for all transcripts in the
reference catalog.</p></dd>


<dt id="arg-ncores">nCores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>Integer, number of cores to use for parallel computations.</p></dd>


<dt id="arg-tx-gene">tx2gene<a class="anchor" aria-label="anchor" href="#arg-tx-gene"></a></dt>
<dd><p>A <code>data.frame</code> with transcript-to-gene mapping. Must have
at least two columns, named <code>tx</code> and <code>gene</code>.</p></dd>


<dt id="arg-genome">genome<a class="anchor" aria-label="anchor" href="#arg-genome"></a></dt>
<dd><p>A <code>BSgenome</code> object.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical, whether to print progress messages.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with one element per transcript. Each element is a list with
  five components:</p><dl><dt><code>predCov</code>:</dt>
<dd><p>The predicted coverage profile for the transcript.</p></dd>

<dt><code>strand</code>:</dt>
<dd><p>The annotated strand for the transcript.</p></dd>

<dt><code>junctionCov</code>:</dt>
<dd><p>A <code>data.frame</code> with genomic coordinates and
predicted read coverages for each junction in the transcript.</p></dd>

<dt><code>aveFragLength</code>:</dt>
<dd><p>The estimated average fragment length.</p></dd>

<dt><code>note</code>:</dt>
<dd><p>Either 'covOK', 'covError' or 'covNA'. If 'covOK',
<code>alpine</code> was able to predict a coverage profile. If 'covError' or
'covNA', the coverage profile could not be predicted, most likely because the
transcript is shorter than the fragment length or because no reads in the BAM
file overlapped the transcript. In both these cases, we impose a uniform
coverage profile for the transcript.</p></dd>


</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Soneson C, Love MI, Patro R, Hussain S, Malhotra D, Robinson MD: A junction
coverage compatibility score to quantify the reliability of transcript
abundance estimates and annotation catalogs. bioRxiv doi:10.1101/378539
(2018)</p>
<p>Love MI, Hogenesch JB, Irizarry RA: Modeling of RNA-seq fragment sequence
bias reduces systematic errors in transcript abundance estimation. Nature
Biotechnology 34(12):1287-1291 (2016).</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Charlotte Soneson, Michael I Love</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">gtf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Homo_sapiens.GRCh38.90.chr22.gtf.gz"</span>,</span></span>
<span class="r-in"><span>                   package <span class="op">=</span> <span class="st">"jcc"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/reads.chr22.bam"</span>, package <span class="op">=</span> <span class="st">"jcc"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">biasMod</span> <span class="op">&lt;-</span> <span class="fu"><a href="fitAlpineBiasModel.html">fitAlpineBiasModel</a></span><span class="op">(</span>gtf <span class="op">=</span> <span class="va">gtf</span>, bam <span class="op">=</span> <span class="va">bam</span>,</span></span>
<span class="r-in"><span>                              organism <span class="op">=</span> <span class="st">"Homo_sapiens"</span>,</span></span>
<span class="r-in"><span>                              genome <span class="op">=</span> <span class="va">Hsapiens</span>, genomeVersion <span class="op">=</span> <span class="st">"GRCh38"</span>,</span></span>
<span class="r-in"><span>                              version <span class="op">=</span> <span class="fl">90</span>, minLength <span class="op">=</span> <span class="fl">230</span>,</span></span>
<span class="r-in"><span>                              maxLength <span class="op">=</span> <span class="fl">7000</span>, minCount <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                              maxCount <span class="op">=</span> <span class="fl">10000</span>, subsample <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                              nbrSubsample <span class="op">=</span> <span class="fl">30</span>, seed <span class="op">=</span> <span class="fl">1</span>, minSize <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                              maxSize <span class="op">=</span> <span class="fl">220</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tx2gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/tx2gene.sub.rds"</span>, package <span class="op">=</span> <span class="st">"jcc"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">predCovProfiles</span> <span class="op">&lt;-</span> <span class="fu">predictTxCoverage</span><span class="op">(</span>biasModel <span class="op">=</span> <span class="va">biasMod</span><span class="op">$</span><span class="va">biasModel</span>,</span></span>
<span class="r-in"><span>                                     exonsByTx <span class="op">=</span> <span class="va">biasMod</span><span class="op">$</span><span class="va">exonsByTx</span>,</span></span>
<span class="r-in"><span>                                     bam <span class="op">=</span> <span class="va">bam</span>, tx2gene <span class="op">=</span> <span class="va">tx2gene</span>,</span></span>
<span class="r-in"><span>                                     genome <span class="op">=</span> <span class="va">Hsapiens</span>,</span></span>
<span class="r-in"><span>                                     genes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ENSG00000070371"</span>,</span></span>
<span class="r-in"><span>                                               <span class="st">"ENSG00000093010"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                     nCores <span class="op">=</span> <span class="fl">1</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Charlotte Soneson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

      </footer></div>






  </body></html>

